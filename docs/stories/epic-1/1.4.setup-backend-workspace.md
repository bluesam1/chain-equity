# Story 1.4: Set Up Backend Workspace

## Status
Ready for Review

## Story

**As a** backend developer,
**I want** a TypeScript backend workspace configured,
**so that** I can build backend services for issuer operations and cap-table generation.

## Acceptance Criteria

1. Backend workspace initialized with `package.json`
2. TypeScript configured with `tsconfig.json`
3. Required dependencies installed: ethers.js, Supabase client, TypeScript
4. Project structure created: `src/` directory with subdirectories
5. TypeScript compilation works correctly
6. Backend services can be run with Node.js

## Tasks / Subtasks

- [x] Initialize backend workspace (AC: 1)
  - [x] Create `backend/package.json`
  - [x] Configure package.json with name, version, and scripts
- [x] Install required dependencies (AC: 3)
  - [x] Install `typescript` (^5.x) as dev dependency
  - [x] Install `@types/node` as dev dependency
  - [x] Install `ethers` (^6.x)
  - [x] Install `@supabase/supabase-js` (^2.x)
- [x] Configure TypeScript (AC: 2)
  - [x] Create `tsconfig.json` in backend workspace
  - [x] Configure TypeScript for Node.js environment
  - [x] Set up output directory (e.g., `dist/`)
- [x] Create project directory structure (AC: 4)
  - [x] Create `src/` directory
  - [x] Create `src/cap-table.ts` for cap-table service
  - [x] Create `src/issuer.ts` for issuer service
  - [x] Create `src/utils/` directory for utilities
  - [x] Create `src/types/` directory for TypeScript types
- [x] Configure build scripts (AC: 5, 6)
  - [x] Add `build` script to compile TypeScript
  - [x] Add `start` script to run compiled JavaScript
  - [x] Add `dev` script for development (with watch mode if needed)
- [x] Verify backend setup (AC: 5, 6)
  - [x] Run `npm run build` to verify TypeScript compilation
  - [x] Verify output files are generated in `dist/`
  - [x] Test running compiled JavaScript with Node.js

## Dev Notes

### Relevant Source Tree Info
- Backend workspace: `backend/`
- Cap-table service: `backend/src/cap-table.ts`
- Issuer service: `backend/src/issuer.ts`
- Utilities: `backend/src/utils/`
- Types: `backend/src/types/`
- TypeScript config: `backend/tsconfig.json`
- Build output: `backend/dist/`

### Architecture Decisions
- TypeScript for type safety
- Node.js runtime environment
- ethers.js v6 for blockchain interactions
- Supabase client for authentication integration
- Direct blockchain queries for cap-table generation (no database)

### Key Constraints
- Must use TypeScript throughout
- Must use ethers.js v6 (not v5)
- No database required for cap-table (queries blockchain directly)
- Backend services run as Node.js scripts/CLI tools

### Testing
- **Test File Location**: `backend/__tests__/` or `backend/src/__tests__/`
- **Test Standards**: Use Jest or Vitest for testing
- **Testing Frameworks**: Jest with TypeScript support or Vitest
- **Specific Requirements**: 
  - Tests should be written in TypeScript
  - Test files should follow naming convention: `*.test.ts`
  - Mock blockchain interactions for unit tests

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-XX | 1.0 | Initial story creation | Product Owner |
| 2024-12-XX | 1.1 | Backend workspace setup completed | Developer |

## Dev Agent Record

### Agent Model Used
Auto (Agent Router)

### Debug Log References
None - setup completed successfully

### Completion Notes List
- Initialized backend workspace with package.json configured with build, start, and dev scripts
- Installed all required dependencies: TypeScript ~5.9.3, @types/node ^24.10.0, ethers ^6.15.0, @supabase/supabase-js ^2.80.0
- Configured TypeScript with tsconfig.json for Node.js environment with ES2022 target, ESNext modules, and strict type checking
- Created project directory structure: src/, src/cap-table.ts, src/issuer.ts, src/utils/, src/types/
- Created entry point file src/index.ts that exports cap-table and issuer services
- Configured build scripts: `build` (tsc), `start` (node dist/index.js), `dev` (tsc --watch)
- Verified TypeScript compilation: `npm run build` successfully compiles to `dist/` directory
- Verified output files generated: dist/ contains compiled .js, .d.ts, and .map files
- Tested running compiled JavaScript: `node dist/index.js` executes successfully

### File List
- `backend/package.json` (updated with scripts and dependencies)
- `backend/tsconfig.json` (created with Node.js configuration)
- `backend/src/index.ts` (created - entry point)
- `backend/src/cap-table.ts` (created - cap-table service with interfaces)
- `backend/src/issuer.ts` (created - issuer service class)
- `backend/src/utils/` (directory created)
- `backend/src/types/` (directory created)
- `backend/dist/` (generated by build - compiled JavaScript output)

## QA Results
_To be populated by QA agent_

