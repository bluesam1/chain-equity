# Story 1.9: Transaction Detail Modal

## Status
Draft

## Story

**As a** user,
**I want** to view detailed information about a specific transaction,
**so that** I can see all transaction details including event-specific data.

## Acceptance Criteria

1. Create TransactionDetailModal component following design system modal patterns
2. Open modal when user clicks on a transaction row
3. Display full transaction details:
   - Transaction type and status
   - Complete timestamp and block number
   - Full from/to addresses (with copy buttons)
   - Amount/value with full precision
   - All event-specific information (split multiplier, symbol change details, allowlist status, etc.)
   - Transaction hash with link to block explorer (if available)
   - Gas used and gas price (if available)
4. Modal follows existing design system (dark theme, centered overlay)
5. Close button and click-outside-to-close functionality
6. Keyboard accessible (ESC to close, Tab navigation)
7. Screen reader support with proper ARIA labels
8. Handle long content (scrollable if needed)
9. Display loading state if fetching additional transaction details
10. Support opening modal via keyboard navigation

## Tasks / Subtasks

- [ ] Create transaction detail modal component (AC: 1, 4)
  - [ ] Create `frontend/src/components/TransactionHistory/TransactionDetailModal.tsx`
  - [ ] Follow existing design system modal patterns
  - [ ] Use dark theme (Slate-800 background, Slate-900 overlay)
  - [ ] Center modal on screen
  - [ ] Add overlay with 80% opacity
- [ ] Implement modal opening (AC: 2)
  - [ ] Open modal when user clicks on transaction row
  - [ ] Pass selected transaction to modal
  - [ ] Handle modal state in parent component
- [ ] Implement transaction details display (AC: 3)
  - [ ] Display transaction type and status
  - [ ] Display complete timestamp and block number
  - [ ] Display full from/to addresses with copy buttons
  - [ ] Display amount/value with full precision
  - [ ] Display event-specific information (split multiplier, symbol change details, allowlist status)
  - [ ] Display transaction hash with link to block explorer
  - [ ] Display gas used and gas price (if available)
- [ ] Implement modal closing (AC: 5)
  - [ ] Add close button (X icon) in top-right corner
  - [ ] Implement click-outside-to-close functionality
  - [ ] Prevent closing during loading state
- [ ] Implement keyboard accessibility (AC: 6)
  - [ ] Support ESC key to close modal
  - [ ] Support Tab navigation within modal
  - [ ] Trap focus within modal
  - [ ] Add focus indicators
- [ ] Implement screen reader support (AC: 7)
  - [ ] Add proper ARIA labels
  - [ ] Use role="dialog" and aria-modal="true"
  - [ ] Add aria-labelledby and aria-describedby
  - [ ] Announce modal opening/closing
- [ ] Implement scrollable content (AC: 8)
  - [ ] Handle long content with internal scrolling
  - [ ] Set max-height to 80vh
  - [ ] Add scrollbar when content exceeds max height
- [ ] Implement loading state (AC: 9)
  - [ ] Display loading state if fetching additional transaction details
  - [ ] Show loading spinner in modal
  - [ ] Disable close button during loading
- [ ] Implement keyboard navigation support (AC: 10)
  - [ ] Support opening modal via keyboard (Enter/Space on transaction row)
  - [ ] Ensure proper focus management

## Dev Notes

### Relevant Source Tree Info
- Transaction detail modal: `frontend/src/components/TransactionHistory/TransactionDetailModal.tsx`
- Transaction row component: `frontend/src/components/TransactionHistory/TransactionRow.tsx` (from Story 1.2)
- Modal base component: Use existing modal component from design system (if available)

### Modal Design Specifications
**Dimensions:**
- Width: 600px (desktop), 90vw (mobile)
- Max Height: 80vh with internal scrolling
- Padding: 2rem (32px) internal padding
- Border Radius: 0.5rem (8px)
- Shadow: Large shadow for depth

**Styling:**
- Background: Slate-800
- Overlay: Slate-900 with 80% opacity
- Close Button: Top-right corner, 32x32px, X icon

### Transaction Details Layout
**Header:**
- Transaction type badge
- Transaction status
- Close button

**Content:**
- Timestamp: Full date and time
- Block number: With link to block explorer
- Transaction hash: Full hash with copy button and block explorer link
- From address: Full address with copy button
- To address: Full address with copy button
- Amount: Full precision with token symbol
- Event-specific data:
  - Split: Multiplier value
  - SymbolChange: Old symbol → New symbol
  - AllowlistUpdate: Account address, approved status
- Gas used: If available
- Gas price: If available

### Modal Animation
**Open:**
- Fade + scale (250ms ease-out)
- Opacity: 0 → 1
- Scale: 0.95 → 1

**Close:**
- Fade + scale (200ms ease-out, reverse)
- Opacity: 1 → 0
- Scale: 1 → 0.95

### Accessibility Implementation
```tsx
<div 
  role="dialog"
  aria-modal="true"
  aria-labelledby="transaction-detail-title"
  aria-describedby="transaction-detail-content"
>
  <h2 id="transaction-detail-title">Transaction Details</h2>
  <div id="transaction-detail-content">
    {/* Transaction details */}
  </div>
</div>
```

### Focus Management
- Trap focus within modal
- Return focus to transaction row when modal closes
- Focus first interactive element when modal opens
- Support Tab navigation within modal

### Block Explorer Link
**Configuration:**
- Hardhat local network: No block explorer
- Sepolia testnet: Etherscan (https://sepolia.etherscan.io)
- Mainnet: Etherscan (https://etherscan.io)
- Make block explorer URL configurable via environment variable

### Integration Points
- Extends `TransactionRow` component from Story 1.2
- Uses existing modal component from design system (if available)
- Uses copy button component for addresses
- Follows existing frontend patterns

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-19 | 1.0 | Initial story creation | John (PM) |

## Dev Agent Record

_To be populated when story is implemented_

## QA Results

_To be populated by QA agent_




