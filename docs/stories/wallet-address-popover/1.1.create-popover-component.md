# Story 1.1: Create Wallet Address Popover Component

## Status
Ready for Review

## Story

**As a** user,
**I want** a popover to appear when I hover over wallet addresses,
**so that** I can quickly access wallet information without navigating away from my current context.

## Acceptance Criteria

1. Create `WalletAddressPopover` component at `frontend/src/components/WalletAddressPopover.tsx`
2. Popover appears on hover with 300ms delay (prevents accidental triggers)
3. Popover hides 200ms after mouse leaves both address and popover
4. Popover remains visible when hovering over it
5. Implement smart positioning that adjusts based on viewport edges
6. Position popover above address by default, flip to below if near top of viewport
7. Adjust horizontally if near viewport edges to ensure popover remains fully visible
8. Apply design system styling (dark theme, proper spacing, typography)
9. Popover container uses `bg-surface`, `border border-border`, `rounded-lg`, `shadow-xl`
10. Popover has max width of `max-w-sm` (384px) and padding of `p-4` (16px)
11. Z-index high enough to appear above other content (z-50)
12. Component accepts required `address: string` prop
13. Component accepts optional `trigger?: React.ReactNode` prop (defaults to address display)
14. Component accepts optional `position?: 'top' | 'bottom' | 'left' | 'right'` prop
15. Component accepts optional `showOnHover?: boolean` prop (default: true)

## Tasks / Subtasks

- [x] Create WalletAddressPopover component structure (AC: 1, 12-15)
  - [x] Create `frontend/src/components/WalletAddressPopover.tsx`
  - [x] Define TypeScript interface for props
  - [x] Set up component with required and optional props
  - [x] Add default prop values
- [x] Implement hover trigger logic (AC: 2, 3, 4)
  - [x] Add hover state management with useState
  - [x] Implement 300ms delay before showing popover
  - [x] Implement 200ms delay before hiding popover
  - [x] Ensure popover remains visible when hovering over it
  - [x] Use useRef to track hover state on both trigger and popover
- [x] Implement smart positioning (AC: 5, 6, 7)
  - [x] Use useRef and getBoundingClientRect() for positioning
  - [x] Calculate position relative to trigger element
  - [x] Detect viewport edges and adjust position accordingly
  - [x] Position above by default, flip to below if near top
  - [x] Adjust horizontally if near left/right edges
  - [x] Ensure popover remains fully visible
- [x] Apply design system styling (AC: 8, 9, 10, 11)
  - [x] Use dark theme colors from design system
  - [x] Apply `bg-surface`, `border border-border`, `rounded-lg`, `shadow-xl`
  - [x] Set max width to `max-w-sm` and padding to `p-4`
  - [x] Set z-index to z-50
  - [x] Follow typography scale from design system
  - [x] Apply proper spacing guidelines

## Dev Notes

### Relevant Source Tree Info
- Popover component: `frontend/src/components/WalletAddressPopover.tsx`
- Design system reference: `docs/front-end-spec.md`
- Existing popover/tooltip patterns: None (new component)

### Front-End Specification References
- **Design System:** See `docs/front-end-spec.md` - Component Library / Design System section
- **Dark Theme:** Use Slate-900 background, Slate-800 surfaces
- **Typography:** Follow existing typography scale
- **Spacing:** Follow spacing guidelines (p-4 for padding, space-y-3 for sections)

### Positioning Implementation
- Use `useRef` to get trigger element reference
- Use `getBoundingClientRect()` to get trigger position
- Calculate popover position relative to trigger
- Check viewport dimensions with `window.innerWidth` and `window.innerHeight`
- Adjust position to keep popover within viewport bounds

### Hover State Management
```typescript
const [isVisible, setIsVisible] = useState(false);
const hoverTimeoutRef = useRef<NodeJS.Timeout | null>(null);
const hideTimeoutRef = useRef<NodeJS.Timeout | null>(null);

// Show with delay
const handleMouseEnter = () => {
  clearTimeout(hideTimeoutRef.current);
  hoverTimeoutRef.current = setTimeout(() => {
    setIsVisible(true);
  }, 300);
};

// Hide with delay
const handleMouseLeave = () => {
  clearTimeout(hoverTimeoutRef.current);
  hideTimeoutRef.current = setTimeout(() => {
    setIsVisible(false);
  }, 200);
};
```

### Integration Points
- Component will be used by TransactionRow, Table, WalletBadge, and Balance components
- Follows existing React component patterns
- Uses TypeScript for type safety
- Follows existing design system conventions

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-XX | 1.0 | Initial story creation | John (PM) |
| 2024-12-XX | 1.1 | Story implementation completed | James (Dev) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5 (via Cursor)

### Debug Log References
N/A - No debug issues encountered

### Completion Notes List
1. Created WalletAddressPopover component with TypeScript interface
2. Implemented hover trigger logic with 300ms show delay and 200ms hide delay
3. Implemented smart positioning that adjusts based on viewport edges
4. Applied design system styling (bg-surface, border-border, rounded-lg, shadow-xl)
5. Component accepts required address prop and optional trigger, position, showOnHover props
6. Position calculation handles viewport edge detection and flips position when needed
7. Component exported from index.ts

### File List
- `frontend/src/components/WalletAddressPopover.tsx` (created)
- `frontend/src/components/index.ts` (modified - added export)

## QA Results

_To be populated by QA agent_

