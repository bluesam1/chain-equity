# Story 5.9: Implement Admin Panel - Mint Tokens

## Status
Draft

## Story

**As an** admin user,
**I want** to mint tokens to approved wallets,
**so that** I can distribute tokens to approved users.

## Acceptance Criteria

1. Admin Mint Tokens section implemented per Front-End Specification (`docs/front-end-spec.md`)
2. Mint Tokens flow implemented per specification (Admin: Mint Tokens user flow)
3. Mint Tokens form with recipient address and amount inputs
4. Real-time address validation (format and allowlist check)
5. Amount validation (positive number, within limits)
6. Confirmation dialog before minting
7. Transaction submission to contract
8. Transaction status indicators (pending, success, error)
9. Balance update after successful mint
10. Error handling for all edge cases:
    - Recipient not approved
    - Invalid amount
    - Invalid address
    - Transaction failure
11. Link to Approve Wallet section if recipient not approved
12. UI follows Dashboard - Admin Tab wireframe from specification
13. Accessible (keyboard navigation, screen reader)

## Tasks / Subtasks

- [ ] Add Mint Tokens section to Admin tab (AC: 1, 12)
  - [ ] Add Mint Tokens section to `frontend/src/pages/Admin.tsx`
  - [ ] Implement mint form per wireframe
  - [ ] Use dark theme colors
  - [ ] Follow wireframe from specification
- [ ] Implement Mint Tokens form (AC: 3)
  - [ ] Add recipient address input
  - [ ] Add amount input
  - [ ] Add "Mint" button
  - [ ] Use Input and Button components from Story 5.2
  - [ ] Use Card component for section
- [ ] Implement address validation (AC: 4)
  - [ ] Validate address format (real-time)
  - [ ] Check recipient on allowlist
  - [ ] Show validation indicators (checkmark/X icon)
  - [ ] Show error messages below invalid inputs
- [ ] Implement amount validation (AC: 5)
  - [ ] Validate positive number
  - [ ] Validate within limits
  - [ ] Show validation errors
  - [ ] Disable mint button if invalid
- [ ] Implement confirmation dialog (AC: 6)
  - [ ] Show confirmation dialog before minting
  - [ ] Display mint details (recipient, amount)
  - [ ] Use Modal component from Story 5.2
  - [ ] Follow confirmation dialog wireframe
- [ ] Implement transaction submission (AC: 7)
  - [ ] Create `frontend/src/lib/contract.ts` (if not exists)
  - [ ] Implement mint transaction
  - [ ] Trigger MetaMask popup
  - [ ] Handle transaction approval/rejection
- [ ] Implement transaction status indicators (AC: 8)
  - [ ] Show pending status (spinner)
  - [ ] Show success status (checkmark + message)
  - [ ] Show error status (error icon + message)
  - [ ] Use StatusIndicator component from Story 5.2
- [ ] Implement balance update (AC: 9)
  - [ ] Query contract for recipient balance
  - [ ] Update balance display after mint
  - [ ] Refresh balance
- [ ] Implement error handling (AC: 10)
  - [ ] Handle recipient not approved (clear error with link to approve wallet)
  - [ ] Handle invalid amount (validate before transaction)
  - [ ] Handle invalid address (real-time validation)
  - [ ] Handle transaction failure (show error with retry)
  - [ ] Follow error handling from specification
- [ ] Implement link to Approve Wallet (AC: 11)
  - [ ] Add link to Approve Wallet section if recipient not approved
  - [ ] Scroll to Approve Wallet section on click
- [ ] Verify accessibility (AC: 13)
  - [ ] Test keyboard navigation
  - [ ] Test screen reader compatibility
  - [ ] Verify focus indicators
  - [ ] Verify form labels

## Dev Notes

### Relevant Source Tree Info
- Admin page: `frontend/src/pages/Admin.tsx`
- Contract interaction: `frontend/src/lib/contract.ts`
- Components: Use components from Story 5.2

### Front-End Specification References
- **User Flow:** See `docs/front-end-spec.md` - User Flows > Admin: Mint Tokens section
- **Wireframe:** See `docs/front-end-spec.md` - Wireframes & Mockups > Dashboard - Admin Tab section
- **Edge Cases:** See `docs/front-end-spec.md` - User Flows > Admin: Mint Tokens > Edge Cases & Error Handling
- **Components:** Use components from Story 5.2

### Architecture Decisions
- Recipient must be approved before minting
- Confirmation dialog before minting
- Balance updated after successful mint
- Link to Approve Wallet if recipient not approved

### Key Constraints
- Must follow mint tokens flow from specification exactly
- Must validate recipient approval before minting
- Must handle all edge cases from specification
- Must use dark theme colors
- Must be accessible

### Testing
- **Test File Location**: `frontend/src/pages/__tests__/Admin.test.tsx`
- **Test Standards**: React Testing Library, Vitest
- **Testing Frameworks**: Vitest with React Testing Library
- **Specific Requirements**: 
  - Test mint tokens form
  - Test address validation
  - Test amount validation
  - Test confirmation dialog
  - Test transaction submission
  - Test transaction status
  - Test error handling (all edge cases)
  - Test balance update
  - Manual testing with contract

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-19 | 1.0 | Initial story creation | Product Owner |

## Dev Agent Record

_To be populated by development agent during implementation_

## QA Results

_To be populated by QA agent_

