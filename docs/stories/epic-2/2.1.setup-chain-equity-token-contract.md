# Story 2.1: Setup ChainEquityToken Contract Structure

## Status
Ready for Review

## Story

**As a** developer,
**I want** to create the ChainEquityToken contract with ERC-20 base functionality and AccessControl integration,
**so that** I have a foundation for implementing token functionality with role-based access control.

## Acceptance Criteria

1. ChainEquityToken contract created inheriting from OpenZeppelin ERC20 and AccessControl
2. Contract initialized with name "Chain Equity Token" and initial symbol
3. DEFAULT_ADMIN_ROLE granted to deployer
4. MINTER_ROLE and APPROVER_ROLE defined and can be granted/revoked
5. Contract compiles without errors
6. Basic ERC-20 functions (balanceOf, totalSupply, symbol) work correctly

## Tasks / Subtasks

- [x] Create ChainEquityToken.sol contract file (AC: 1)
  - [x] Import OpenZeppelin ERC20 contract
  - [x] Import OpenZeppelin AccessControl contract
  - [x] Define ChainEquityToken contract inheriting from both
- [x] Implement constructor with initialization (AC: 2, 3)
  - [x] Initialize ERC20 with name "Chain Equity Token" and initial symbol
  - [x] Initialize AccessControl
  - [x] Grant DEFAULT_ADMIN_ROLE to deployer
- [x] Define role constants (AC: 4)
  - [x] Define MINTER_ROLE constant
  - [x] Define APPROVER_ROLE constant
  - [x] Implement role granting/revoking functions
- [x] Verify contract compilation (AC: 5)
  - [x] Run Hardhat compile
  - [x] Fix any compilation errors
- [x] Test basic ERC-20 functionality (AC: 6)
  - [x] Deploy contract in test
  - [x] Verify balanceOf returns 0 for new addresses
  - [x] Verify totalSupply returns 0 initially
  - [x] Verify symbol returns initial value

## Dev Notes

### Relevant Source Tree Info
- Contract location: `contracts/src/ChainEquityToken.sol`
- Test location: `contracts/test/ChainEquityToken.test.ts`
- Hardhat configuration: `contracts/hardhat.config.ts`
- TypeChain types will be generated in `contracts/typechain-types/`

### Architecture Decisions
- Using OpenZeppelin contracts for security and standardization
- Inheritance hierarchy: ERC20 → AccessControl → ChainEquityToken
- Role-based access control for admin functions
- Contract name: "Chain Equity Token" (fixed)
- Initial symbol will be configurable (will be made mutable in later story)

### Key Constraints
- Must use OpenZeppelin v5.x contracts (check package.json version)
- Must follow Solidity 0.8.x syntax
- Must use Hardhat for compilation and testing
- Contract must be upgradeable-safe (no storage layout conflicts)

### Testing

**Test File Location**: `contracts/test/ChainEquityToken.test.ts`

**Test Standards**: 
- Use Hardhat with ethers.js v6 API
- Use Chai for assertions
- Test all public/external functions
- Test role-based access control

**Testing Frameworks**: 
- Hardhat
- ethers.js v6
- Chai

**Specific Requirements**: 
- Test contract deployment
- Test role granting/revoking
- Test basic ERC-20 view functions
- Test that DEFAULT_ADMIN_ROLE is granted to deployer
- Test that MINTER_ROLE and APPROVER_ROLE can be granted/revoked

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-XX | 1.0 | Initial story creation | Product Owner |
| 2024-12-06 | 1.1 | Implemented ChainEquityToken contract with ERC20 and AccessControl, added comprehensive test suite | Dev Agent |

## Dev Agent Record

### Agent Model Used
Auto (Cursor Agent Router)

### Debug Log References
No debug log entries required - all tests passed successfully

### Completion Notes List
- Created ChainEquityToken.sol contract inheriting from OpenZeppelin ERC20 and AccessControl
- Implemented constructor with name "Chain Equity Token" and configurable initial symbol parameter
- Granted DEFAULT_ADMIN_ROLE to deployer in constructor
- Defined MINTER_ROLE and APPROVER_ROLE constants using keccak256 hashing
- Implemented grantRole and revokeRole functions (inherited from AccessControl, overridden for clarity)
- Contract compiles successfully with Solidity 0.8.28
- Created comprehensive test suite with 14 tests covering:
  - Deployment with correct name and symbol
  - DEFAULT_ADMIN_ROLE assignment to deployer
  - Role constant definitions (MINTER_ROLE, APPROVER_ROLE)
  - Role granting and revoking functionality
  - Access control enforcement (non-admin cannot grant roles)
  - Basic ERC-20 view functions (balanceOf, totalSupply, symbol, name)
- All 14 tests pass successfully

### File List
- `contracts/src/ChainEquityToken.sol` (created)
- `contracts/test/ChainEquityToken.test.ts` (created)

## QA Results
_To be populated by QA agent_

